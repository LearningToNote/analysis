SET SCHEMA "LEARNING_TO_NOTE";

DROP TYPE T_DISTINCT_TOKENS;
DROP TABLE DISTINCT_TOKENS;

CREATE TYPE T_DISTINCT_TOKENS AS TABLE(ID INT, TOKEN nvarchar(255));
CREATE COLUMN TABLE DISTINCT_TOKENS(ID INT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY, TOKEN nvarchar(255));

INSERT INTO DISTINCT_TOKENS(TOKEN)
SELECT DISTINCT
CASE WHEN FTI.TA_STEM IS NULL THEN FTI.TA_NORMALIZED ELSE FTI.TA_STEM END AS TOKEN
FROM "$TA_FTI" FTI
WHERE FTI.TA_TYPE <> 'punctuation'
AND FTI.TA_TYPE <> 'number'
;

SELECT count(*) FROM DISTINCT_TOKENS;
